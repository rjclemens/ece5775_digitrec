-- ==============================================================
-- RTL generated by Vivado(TM) HLS - High-Level Synthesis from C, C++ and SystemC
-- Version: 2016.2
-- Copyright (C) 1986-2016 Xilinx, Inc. All Rights Reserved.
-- 
-- ===========================================================

library IEEE;
use IEEE.std_logic_1164.all;
use IEEE.numeric_std.all;

entity digitrec_update_knn is
port (
    test_inst_V : IN STD_LOGIC_VECTOR (48 downto 0);
    train_inst_V : IN STD_LOGIC_VECTOR (47 downto 0);
    min_distances_0_V_i : IN STD_LOGIC_VECTOR (5 downto 0);
    min_distances_0_V_o : OUT STD_LOGIC_VECTOR (5 downto 0);
    min_distances_0_V_o_ap_vld : OUT STD_LOGIC;
    min_distances_1_V_i : IN STD_LOGIC_VECTOR (5 downto 0);
    min_distances_1_V_o : OUT STD_LOGIC_VECTOR (5 downto 0);
    min_distances_1_V_o_ap_vld : OUT STD_LOGIC;
    min_distances_2_V_i : IN STD_LOGIC_VECTOR (5 downto 0);
    min_distances_2_V_o : OUT STD_LOGIC_VECTOR (5 downto 0);
    min_distances_2_V_o_ap_vld : OUT STD_LOGIC );
end;


architecture behav of digitrec_update_knn is 
    constant ap_true : BOOLEAN := true;
    constant ap_const_lv1_0 : STD_LOGIC_VECTOR (0 downto 0) := "0";
    constant ap_const_lv2_1 : STD_LOGIC_VECTOR (1 downto 0) := "01";
    constant ap_const_logic_0 : STD_LOGIC := '0';
    constant ap_const_logic_1 : STD_LOGIC := '1';
    constant ap_const_lv2_0 : STD_LOGIC_VECTOR (1 downto 0) := "00";
    constant ap_const_lv2_2 : STD_LOGIC_VECTOR (1 downto 0) := "10";

    signal distance_V_digitrec_bitcount_fu_89_n_V : STD_LOGIC_VECTOR (48 downto 0);
    signal distance_V_digitrec_bitcount_fu_89_ap_return : STD_LOGIC_VECTOR (5 downto 0);
    signal tmp_1_fu_152_p2 : STD_LOGIC_VECTOR (0 downto 0);
    signal p_026_1_2_fu_132_p3 : STD_LOGIC_VECTOR (1 downto 0);
    signal train_inst_V_cast_fu_97_p1 : STD_LOGIC_VECTOR (48 downto 0);
    signal tmp_3_1_fu_108_p2 : STD_LOGIC_VECTOR (0 downto 0);
    signal p_030_1_1_fu_114_p3 : STD_LOGIC_VECTOR (5 downto 0);
    signal tmp_3_2_fu_126_p2 : STD_LOGIC_VECTOR (0 downto 0);
    signal p_026_1_1_fu_122_p1 : STD_LOGIC_VECTOR (1 downto 0);
    signal tmp_fu_140_p4 : STD_LOGIC_VECTOR (1 downto 0);
    signal tmp_fu_140_p5 : STD_LOGIC_VECTOR (5 downto 0);

    component digitrec_bitcount IS
    port (
        n_V : IN STD_LOGIC_VECTOR (48 downto 0);
        ap_return : OUT STD_LOGIC_VECTOR (5 downto 0) );
    end component;


    component digitrec_mux_3to1_sel2_6_1 IS
    generic (
        ID : INTEGER;
        NUM_STAGE : INTEGER;
        din1_WIDTH : INTEGER;
        din2_WIDTH : INTEGER;
        din3_WIDTH : INTEGER;
        din4_WIDTH : INTEGER;
        dout_WIDTH : INTEGER );
    port (
        din1 : IN STD_LOGIC_VECTOR (5 downto 0);
        din2 : IN STD_LOGIC_VECTOR (5 downto 0);
        din3 : IN STD_LOGIC_VECTOR (5 downto 0);
        din4 : IN STD_LOGIC_VECTOR (1 downto 0);
        dout : OUT STD_LOGIC_VECTOR (5 downto 0) );
    end component;



begin
    distance_V_digitrec_bitcount_fu_89 : component digitrec_bitcount
    port map (
        n_V => distance_V_digitrec_bitcount_fu_89_n_V,
        ap_return => distance_V_digitrec_bitcount_fu_89_ap_return);

    digitrec_mux_3to1_sel2_6_1_U2 : component digitrec_mux_3to1_sel2_6_1
    generic map (
        ID => 1,
        NUM_STAGE => 1,
        din1_WIDTH => 6,
        din2_WIDTH => 6,
        din3_WIDTH => 6,
        din4_WIDTH => 2,
        dout_WIDTH => 6)
    port map (
        din1 => min_distances_0_V_i,
        din2 => min_distances_1_V_i,
        din3 => min_distances_2_V_i,
        din4 => tmp_fu_140_p4,
        dout => tmp_fu_140_p5);




    distance_V_digitrec_bitcount_fu_89_n_V <= (train_inst_V_cast_fu_97_p1 xor test_inst_V);

    min_distances_0_V_o_assign_proc : process(min_distances_0_V_i, distance_V_digitrec_bitcount_fu_89_ap_return, tmp_1_fu_152_p2, p_026_1_2_fu_132_p3)
    begin
        if ((not((tmp_1_fu_152_p2 = ap_const_lv1_0)) and (p_026_1_2_fu_132_p3 = ap_const_lv2_0))) then 
            min_distances_0_V_o <= distance_V_digitrec_bitcount_fu_89_ap_return;
        else 
            min_distances_0_V_o <= min_distances_0_V_i;
        end if; 
    end process;


    min_distances_0_V_o_ap_vld_assign_proc : process(tmp_1_fu_152_p2, p_026_1_2_fu_132_p3)
    begin
        if ((not((tmp_1_fu_152_p2 = ap_const_lv1_0)) and (p_026_1_2_fu_132_p3 = ap_const_lv2_0))) then 
            min_distances_0_V_o_ap_vld <= ap_const_logic_1;
        else 
            min_distances_0_V_o_ap_vld <= ap_const_logic_0;
        end if; 
    end process;


    min_distances_1_V_o_assign_proc : process(min_distances_1_V_i, distance_V_digitrec_bitcount_fu_89_ap_return, tmp_1_fu_152_p2, p_026_1_2_fu_132_p3)
    begin
        if ((not((tmp_1_fu_152_p2 = ap_const_lv1_0)) and (p_026_1_2_fu_132_p3 = ap_const_lv2_1))) then 
            min_distances_1_V_o <= distance_V_digitrec_bitcount_fu_89_ap_return;
        else 
            min_distances_1_V_o <= min_distances_1_V_i;
        end if; 
    end process;


    min_distances_1_V_o_ap_vld_assign_proc : process(tmp_1_fu_152_p2, p_026_1_2_fu_132_p3)
    begin
        if ((not((tmp_1_fu_152_p2 = ap_const_lv1_0)) and (p_026_1_2_fu_132_p3 = ap_const_lv2_1))) then 
            min_distances_1_V_o_ap_vld <= ap_const_logic_1;
        else 
            min_distances_1_V_o_ap_vld <= ap_const_logic_0;
        end if; 
    end process;


    min_distances_2_V_o_assign_proc : process(min_distances_2_V_i, distance_V_digitrec_bitcount_fu_89_ap_return, tmp_1_fu_152_p2, p_026_1_2_fu_132_p3)
    begin
        if ((not((tmp_1_fu_152_p2 = ap_const_lv1_0)) and not((p_026_1_2_fu_132_p3 = ap_const_lv2_0)) and not((p_026_1_2_fu_132_p3 = ap_const_lv2_1)))) then 
            min_distances_2_V_o <= distance_V_digitrec_bitcount_fu_89_ap_return;
        else 
            min_distances_2_V_o <= min_distances_2_V_i;
        end if; 
    end process;


    min_distances_2_V_o_ap_vld_assign_proc : process(tmp_1_fu_152_p2, p_026_1_2_fu_132_p3)
    begin
        if ((not((tmp_1_fu_152_p2 = ap_const_lv1_0)) and not((p_026_1_2_fu_132_p3 = ap_const_lv2_0)) and not((p_026_1_2_fu_132_p3 = ap_const_lv2_1)))) then 
            min_distances_2_V_o_ap_vld <= ap_const_logic_1;
        else 
            min_distances_2_V_o_ap_vld <= ap_const_logic_0;
        end if; 
    end process;

    p_026_1_1_fu_122_p1 <= std_logic_vector(resize(unsigned(tmp_3_1_fu_108_p2),2));
    p_026_1_2_fu_132_p3 <= 
        ap_const_lv2_2 when (tmp_3_2_fu_126_p2(0) = '1') else 
        p_026_1_1_fu_122_p1;
    p_030_1_1_fu_114_p3 <= 
        min_distances_1_V_i when (tmp_3_1_fu_108_p2(0) = '1') else 
        min_distances_0_V_i;
    tmp_1_fu_152_p2 <= "1" when (unsigned(distance_V_digitrec_bitcount_fu_89_ap_return) < unsigned(tmp_fu_140_p5)) else "0";
    tmp_3_1_fu_108_p2 <= "1" when (unsigned(min_distances_1_V_i) > unsigned(min_distances_0_V_i)) else "0";
    tmp_3_2_fu_126_p2 <= "1" when (unsigned(min_distances_2_V_i) > unsigned(p_030_1_1_fu_114_p3)) else "0";
    tmp_fu_140_p4 <= 
        ap_const_lv2_2 when (tmp_3_2_fu_126_p2(0) = '1') else 
        p_026_1_1_fu_122_p1;
    train_inst_V_cast_fu_97_p1 <= std_logic_vector(resize(unsigned(train_inst_V),49));
end behav;
